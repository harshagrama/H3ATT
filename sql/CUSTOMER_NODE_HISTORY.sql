SELECT 
    CNH.CUSTOMER_NODE_ID,            
    CNH.LAST_MODIFIED,               
    CNH.EFFECTIVE_START_DATE,        
    CNH.EFFECTIVE_END_DATE,          
    DECODE(CNH.CUSTOMER_NODE_TYPE_ID,4100001,25000000,CNH.CUSTOMER_NODE_TYPE_ID) as CUSTOMER_NODE_TYPE_ID,       
    CNH.PRIMARY_IDENTIFIER,          
    CNH.PRIMARY_IDENTIFIER2,         
    CNH.NODE_NAME,                   
    CNH.NODE_NAME_UPPERCASE,         
    CNH.NODE_NAME_SOUNDEX,           
    CNH.ATLANTA_GROUP_ID,            
    CNH.ATLANTA_OPERATOR_ID,         
    CNH.GL_CODE_ID,                  
    CNH.PARENT_CUSTOMER_NODE_ID,     
    CNH.HIERARCHY_LEVEL,             
    CNH.ROOT_CUSTOMER_NODE_ID,       
    CNH.CUSTOMER_NODE_STATUS_CODE,   
    CNH.CREATED_DATE,                
    CNH.ACTIVE_DATE,                 
    CNH.PERSON_ID,                   
    CNH.PRIME_ACCOUNT_ID,            
    CNH.REPORT_LEVEL_CODE,           
    CNH.POSTAL_ADDRESS_ID,           
    CNH.SITE_ADDRESS_ID,             
    CNH.CURRENCY_ID,                 
    CNH.SCHEDULE_ID,                 
    CNH.BILLING_PRIORITY,            
    CNH.BILLING_COMPLEXITY,          
    CNH.BILLING_CONFIGURATION_CODE,  
    CNH.SUPPRESS_IND_CODE,           
    CNH.SUPPRESS_BILL_CYCLE_COUNT,   
    CNH.SUPPRESS_UNTIL_ISSUE_DATE,   
    CNH.TURNOVER,                    
    CNH.TURNOVER_CURRENCY_ID,        
    CNH.CREDIT_LIMIT,                
    CNH.CREDIT_LIMIT_CURRENCY_ID,    
    CNH.EXPECTED_REVENUE,            
    CNH.EXPECTED_REVENUE_CURRENCY_ID,
    CNH.CREDIT_RATING_CODE,          
    CNH.BANK_ACCOUNT_REF as CREDIT_COMMENTS,             
    DECODE(CNH.TAX_CLASS_CODE,6,1,
                              8,2,CNH.TAX_CLASS_CODE) TAX_CLASS_CODE,              
    CNH.PAYMENT_METHOD_CODE,         
    CNH.PAYMENT_LOCATION_CODE,       
    CNH.BANK_CODE,                   
    CNH.BRANCH_CODE,                 
    CNH.BANK_ACCOUNT_NAME,           
    CNH.BANK_ACCOUNT_NUMBER,         
    CNH.BANK_ACCOUNT_REF,            
    CNH.CARD_TYPE_CODE,              
    CNH.CARD_NUMBER,                 
    CNH.CARD_EXPIRY_DATE,            
    CNH.ASSIGNED_OPERATOR_ID,        
    CNH.SALES_CHANNEL_CODE,          
    CNH.COMPANY_NUMBER,              
    CNH.INDUSTRY_CODE,               
    CNH.REGION_CODE,                 
    SUBSTR(ACC.ACCOUNT_NAME,4) as GENERAL_1,                     
    CNH.GENERAL_6 as GENERAL_2,                   
    CNH.GENERAL_3,                   
    (SELECT DISTINCT BRT.BILL_RUN_TYPE_NAME FROM BILL_RUN_TYPE BRT
            JOIN BILL_RUN BR ON BRT.BILL_RUN_TYPE_ID = BR.BILL_RUN_TYPE_ID AND BR.BILLING_SCHEDULE_ID = CNH.SCHEDULE_ID
            WHERE 1=1) as GENERAL_4,                   
    (SELECT CNDA.RESULT1_VALUE 
       FROM CUSTOMER_NODE_DA_ARRAY CNDA 
      WHERE CNDA.CUSTOMER_NODE_ID = CNH.CUSTOMER_NODE_ID
        AND CNDA.DERIVED_ATTRIBUTE_ID=31001174 
        AND CNDA.INDEX1_VALUE=6
        AND CNH.EFFECTIVE_START_DATE BETWEEN CNDA.EFFECTIVE_START_DATE AND CNDA.EFFECTIVE_END_DATE) as GENERAL_5,                   
    CNH.GENERAL_6,                   
    CNH.GENERAL_7,                   
    CNH.GENERAL_8,                   
    CNH.GENERAL_9,                   
    CNH.GENERAL_10,                  
    CNH.BANK_ACCOUNT_STATUS_CODE,    
    CNH.CARD_NAME,                   
    CNH.CARD_STATUS_CODE
FROM CUSTOMER_NODE_HISTORY CNH
JOIN ACCOUNT ACC ON CNH.CUSTOMER_NODE_ID=ACC.CUSTOMER_NODE_ID AND ACC.GENERAL_2 = 'CLARIFY'
WHERE 1=1    
